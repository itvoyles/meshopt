function [ x, w ] = curtis_clenshaw( order )
%%  Curtis_Clenshaw  Provides quadrature points / weights for the unit interval.
%
%  These nested Curtis-Clenshaw points are determined from John Burkardt's 
%  ccn_rule Matlab function modified with Matlab's vpa
%  http://people.sc.fsu.edu/~jburkardt/m_src/ccn_rule/ccn_rule.html
%
%  Usage:  [ x, w ] = curtis_clenshaw( order );
%
%  The points are ordered to facilitate easy error estimation.  In other words
%  the sequence
%     [ x, w ] = curtis_clenshaw( 4 );
%     f = feval('my_integrand',x);
%     integral = sum( f.*w );
%     [ x, w ] = curtis_clenshaw( 5 );
%     f(5) = my_integrand(x(5));
%     integral_p = sum( f.*w );
%
%  provides both the estimate of the integral (integral) and a more accurate
%  estimate (integral_p) which can be used to infer the error.
%                        
%%  Based on Levels  (final rule integrates exactly to 2*order+1)
  switch order
  case 1
    x = [ 5.000000000000000e-01 ];
    w = [ 1.000000000000000e+00 ];
  case 2
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00 ];
    w = [6.666666666666666e-01; 1.666666666666667e-01; 1.666666666666667e-01 ];
  case 3
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00 ];
    w = [6.666666666666666e-01; 1.666666666666667e-01; 1.666666666666667e-01 ];
  case 4
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01 ];
    w = [4.000000000000000e-01; 3.333333333333333e-02; 3.333333333333333e-02; 2.666666666666667e-01; 2.666666666666667e-01 ];
  case 5
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01 ];
    w = [4.000000000000000e-01; 3.333333333333333e-02; 3.333333333333333e-02; 2.666666666666667e-01; 2.666666666666667e-01 ];
  case 6
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01 ];
    w = [2.699347214334059e-01; 4.449117024051247e-02; 4.449117024051247e-02; 2.127918642905487e-01; 2.127918642905487e-01; 1.077496047522358e-01; 1.077496047522358e-01 ];
  case 7
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01 ];
    w = [2.699347214334059e-01; 4.449117024051247e-02; 4.449117024051247e-02; 2.127918642905487e-01; 2.127918642905487e-01; 1.077496047522358e-01; 1.077496047522358e-01 ];
  case 8
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01 ];
    w = [1.968253968253968e-01; 7.936507936507936e-03; 7.936507936507936e-03; 1.396825396825397e-01; 1.396825396825397e-01; 1.808589293602449e-01; 1.808589293602449e-01; 7.310932460800908e-02; 7.310932460800908e-02 ];
  case 9
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01 ];
    w = [1.968253968253968e-01; 7.936507936507936e-03; 7.936507936507936e-03; 1.396825396825397e-01; 1.396825396825397e-01; 1.808589293602449e-01; 1.808589293602449e-01; 7.310932460800908e-02; 7.310932460800908e-02 ];
  case 10
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01 ];
    w = [1.816599466845090e-01; 8.236527021615175e-03; 8.236527021615175e-03; 1.409320544880720e-01; 1.409320544880720e-01; 1.755335314615404e-01; 1.755335314615404e-01; 7.240153132690921e-02; 7.240153132690921e-02; 1.206638235960867e-02; 1.206638235960867e-02 ];
  case 11
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01 ];
    w = [1.816599466845090e-01; 8.236527021615175e-03; 8.236527021615175e-03; 1.409320544880720e-01; 1.409320544880720e-01; 1.755335314615404e-01; 1.755335314615404e-01; 7.240153132690921e-02; 7.240153132690921e-02; 1.206638235960867e-02; 1.206638235960867e-02 ];
  case 12
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01; 2.222148834901989e-01; 7.777851165098011e-01 ];
    w = [2.440413662809358e-01; 8.787504699270737e-03; 8.787504699270737e-03; 1.492231062546571e-01; 1.492231062546571e-01; 2.172154634389532e-01; 2.172154634389532e-01; 7.075233859195049e-02; 7.075233859195049e-02; -4.454846041601544e-02; -4.454846041601544e-02; -2.345063570928395e-02; -2.345063570928395e-02 ];
  case 13
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01; 2.222148834901989e-01; 7.777851165098011e-01 ];
    w = [2.440413662809358e-01; 8.787504699270737e-03; 8.787504699270737e-03; 1.492231062546571e-01; 1.492231062546571e-01; 2.172154634389532e-01; 2.172154634389532e-01; 7.075233859195049e-02; 7.075233859195049e-02; -4.454846041601544e-02; -4.454846041601544e-02; -2.345063570928395e-02; -2.345063570928395e-02 ];
  case 14
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01; 2.222148834901989e-01; 7.777851165098011e-01; 8.426519384872738e-02; 9.157348061512727e-01 ];
    w = [1.168894143295481e-01; 1.130296002302689e-02; 1.130296002302689e-02; 8.816258560271935e-02; 8.816258560271935e-02; 1.094212435368495e-01; 1.094212435368495e-01; 5.642551719017872e-02; 5.642551719017872e-02; 7.757258088786002e-02; 7.757258088786002e-02; 6.290198072224884e-02; 6.290198072224884e-02; 3.576842487234266e-02; 3.576842487234266e-02 ];
  case 15
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01; 2.222148834901989e-01; 7.777851165098011e-01; 8.426519384872738e-02; 9.157348061512727e-01 ];
    w = [1.168894143295481e-01; 1.130296002302689e-02; 1.130296002302689e-02; 8.816258560271935e-02; 8.816258560271935e-02; 1.094212435368495e-01; 1.094212435368495e-01; 5.642551719017872e-02; 5.642551719017872e-02; 7.757258088786002e-02; 7.757258088786002e-02; 6.290198072224884e-02; 6.290198072224884e-02; 3.576842487234266e-02; 3.576842487234266e-02 ];
  case 16
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01; 2.222148834901989e-01; 7.777851165098011e-01; 8.426519384872738e-02; 9.157348061512727e-01; 9.607359798384776e-03; 9.903926402016152e-01 ];
    w = [9.820506291094526e-02; 1.960784313725490e-03; 1.960784313725490e-03; 6.947823418411654e-02; 6.947823418411654e-02; 9.073689211824668e-02; 9.073689211824668e-02; 3.774116577157591e-02; 3.774116577157591e-02; 9.625693230646282e-02; 9.625693230646282e-02; 8.158633214085165e-02; 8.158633214085165e-02; 5.445277629094546e-02; 5.445277629094546e-02; 1.868435141860280e-02; 1.868435141860280e-02 ];
  case 17
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01; 2.222148834901989e-01; 7.777851165098011e-01; 8.426519384872738e-02; 9.157348061512727e-01; 9.607359798384776e-03; 9.903926402016152e-01 ];
    w = [9.820506291094526e-02; 1.960784313725490e-03; 1.960784313725490e-03; 6.947823418411654e-02; 6.947823418411654e-02; 9.073689211824668e-02; 9.073689211824668e-02; 3.774116577157591e-02; 3.774116577157591e-02; 9.625693230646282e-02; 9.625693230646282e-02; 8.158633214085165e-02; 8.158633214085165e-02; 5.445277629094546e-02; 5.445277629094546e-02; 1.868435141860280e-02; 1.868435141860280e-02 ];
  case 18
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01; 2.222148834901989e-01; 7.777851165098011e-01; 8.426519384872738e-02; 9.157348061512727e-01; 9.607359798384776e-03; 9.903926402016152e-01; 4.509914298352197e-01; 5.490085701647803e-01 ];
    w = [9.489993092968568e-02; 1.976815123545848e-03; 1.976815123545848e-03; 6.954298554766077e-02; 6.954298554766077e-02; 9.096894244164434e-02; 9.096894244164434e-02; 3.777879091698386e-02; 3.777879091698386e-02; 9.514092581146323e-02; 9.514092581146323e-02; 8.148015092028106e-02; 8.148015092028106e-02; 5.440619862938602e-02; 5.440619862938602e-02; 1.865100844727283e-02; 1.865100844727283e-02; 2.604216696919209e-03; 2.604216696919209e-03 ];
  case 19
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01; 2.222148834901989e-01; 7.777851165098011e-01; 8.426519384872738e-02; 9.157348061512727e-01; 9.607359798384776e-03; 9.903926402016152e-01; 4.509914298352197e-01; 5.490085701647803e-01 ];
    w = [9.489993092968568e-02; 1.976815123545848e-03; 1.976815123545848e-03; 6.954298554766077e-02; 6.954298554766077e-02; 9.096894244164434e-02; 9.096894244164434e-02; 3.777879091698386e-02; 3.777879091698386e-02; 9.514092581146323e-02; 9.514092581146323e-02; 8.148015092028106e-02; 8.148015092028106e-02; 5.440619862938602e-02; 5.440619862938602e-02; 1.865100844727283e-02; 1.865100844727283e-02; 2.604216696919209e-03; 2.604216696919209e-03 ];
  case 20
    x = [5.000000000000000e-01; 0.000000000000000e+00; 1.000000000000000e+00; 1.464466094067262e-01; 8.535533905932737e-01; 3.086582838174551e-01; 6.913417161825449e-01; 3.806023374435662e-02; 9.619397662556434e-01; 4.024548389919358e-01; 5.975451610080641e-01; 2.222148834901989e-01; 7.777851165098011e-01; 8.426519384872738e-02; 9.157348061512727e-01; 9.607359798384776e-03; 9.903926402016152e-01; 4.509914298352197e-01; 5.490085701647803e-01; 3.548576613727688e-01; 6.451423386272311e-01 ];
    w = [1.357836386581305e-01; 1.995062289965240e-03; 1.995062289965240e-03; 6.970533178400107e-02; 6.970533178400107e-02; 9.485877821545795e-02; 9.485877821545795e-02; 3.782977079718051e-02; 3.782977079718051e-02; 1.203169887236214e-01; 1.203169887236214e-01; 8.098692268870639e-02; 8.098692268870639e-02; 5.432622552846302e-02; 5.432622552846302e-02; 1.861140978860473e-02; 1.861140978860473e-02; -3.375474105886143e-02; -3.375474105886143e-02; -1.276756808620410e-02; -1.276756808620410e-02 ];
  otherwise
    error('curtis_clenshaw:  rule is not implemented')
  end

end
